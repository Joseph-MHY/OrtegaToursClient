<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Reserva</title>
    <link rel="stylesheet" th:href="@{/css/personalisacion.css}">
    <link rel="icon" type="image/png" href="/images/Logoot2.png">
</head>
<body>

<!-- Ventana Modal -->
<div id="personalizacion" class="personalizacion">
    <div class="personalizacion-content">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h2>Formulario de Reserva</h2>
        </div>
        <div class="modal-body">
            <form id="reservaForm">
                <div class="form-group">
                    <label for="destino">Destino Turístico Seleccionado:</label>
                    <input type="text" id="destino" name="destino" readonly required>
                </div>

                <div class="form-group">
                    <label for="nombres">Nombres:</label>
                    <input type="text" id="nombres" name="nombres" placeholder="Ingrese su Nombre" required>
                </div>

                <div class="form-group">
                    <label for="apellidos">Apellidos:</label>
                    <input type="text" id="apellidos" name="apellidos" placeholder="Ingrese su Apellido" required>
                </div>

                <div class="form-group">
                    <label for="correo">Correo:</label>
                    <input type="email" id="correo" name="correo" placeholder="Ingrese su correo electrónico" required>
                </div>

                <div class="form-group">
                    <label for="celular">Celular:</label>
                    <input type="tel" id="celular" name="celular" placeholder="Ingrese su número" required maxlength="9" pattern="\d{9}" title="Debe ingresar exactamente 9 números" oninput="validateInput(this)">

                </div>

                <div class="form-group">
                    <label for="fecha">Fecha de Partida:</label>
                    <input type="date" id="fecha" name="fecha" required>
                </div>

                <div class="form-group">
                    <label for="pasajeros">Cantidad de Pasajeros:</label>
                    <input type="number" id="pasajeros" name="pasajeros" placeholder="Ingrese la cantidad" min="1" required>
                </div>

                <div class="form-group">
                    <label for="tipoViaje">Tipo de Viaje:</label>
                    <select id="tipoViaje" name="tipoViaje" required>
                        <option value="PUBLICO">Público</option>
                        <option value="PRIVADO">Privado</option>
                    </select>
                </div>

                <button type="submit">Reservar</button>
            </form>
        </div>
    </div>
</div>

<script th:src="@{/js/personalisacion.js}"></script>
<script>
    // Función para validar el formato del correo electrónico
    function validateEmail(email) {
        // Expresión regular para validar el formato del correo electrónico
        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailPattern.test(email);
    }

    // Abrir la ventana modal y establecer el valor del campo de destino turístico
    function abrirModal() {
        // Obtener el título del paquete
        var titulo = document.querySelector('.paquete-info .titulo').innerText;

        // Establecer el valor del campo "Destino Turístico Seleccionado" con el título del paquete
        document.getElementById('destino').value = titulo;

        // Mostrar la ventana modal
        var modal = document.getElementById('personalizacion');
        modal.style.display = 'block';
    }

    // Cerrar la ventana modal al hacer clic en el botón de cierre
    var closeBtn = document.querySelector('.personalizacion .close');
    if (closeBtn) {
        closeBtn.onclick = function() {
            var modal = document.getElementById('personalizacion');
            modal.style.display = 'none';
        }
    }

    // Cerrar la ventana modal si se hace clic fuera del contenido de la modal
    window.onclick = function(event) {
        var modal = document.getElementById('personalizacion');
        if (event.target == modal) {
            modal.style.display = 'none';
        }
    }

    // Añadir evento de clic al botón de reservar
    document.querySelector('.reservar-btn').addEventListener('click', function() {
        var form = document.getElementById('reservaForm');
        var celularInput = document.getElementById('celular');
        var correoInput = document.getElementById('correo');

        var celular = celularInput.value;
        var correo = correoInput.value;

        // Validar que todos los campos estén completos
        var inputs = form.querySelectorAll('input[required], select[required]');
        var isValid = true;

        for (var input of inputs) {
            if (!input.value.trim()) {
                isValid = false; // Detener el proceso si hay campos vacíos
                break;
            }
        }

        // Validar celular
        if (!/^\d{9}$/.test(celular)) {
            isValid = false; // Detener el proceso si el celular es inválido
        }

        // Validar correo
        if (!validateEmail(correo)) {
            isValid = false; // Detener el proceso si el correo es inválido
        }

        if (!isValid) {
            // Si alguna validación falla, no se envía el formulario
            return; // Detener el proceso
        }

        // Si todas las validaciones son correctas, abrir el modal
        abrirModal();
    });

    // Función para validar el input del celular
    function validateInput(input) {
        // Reemplaza caracteres no numéricos
        input.value = input.value.replace(/[^0-9]/g, '');
    }

    // Añadir evento para validar el celular al cambiar su valor
    var celularInput = document.getElementById('celular');
    if (celularInput) {
        celularInput.addEventListener('input', function() {
            validateInput(celularInput);
        });
    }

    // Función para validar el formato del correo electrónico
    function validateEmail(email) {
        // Expresión regular para validar el formato del correo electrónico
        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailPattern.test(email);
    }

</script>
</body>
</html>
